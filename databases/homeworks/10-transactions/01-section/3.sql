start transaction read write isolation level read committed;
-- Можем изменять таблицу Tickets, так что RU нам точно
-- не подойдет, т.к. поддерживает только read only.
-- Рассмотрим RC: чтение tickets происходит 2 раза (1-ое неявное через view CurrentReservations, 2-ое при обновлении).
-- Может случится так, что будет происходить одновременная покупка / продление брони и продление брони
-- с одного аккаунта (например муж / жена).
-- Это влияет только изменение времени покупки / брони
-- В таком случае будет небольшая погрешность с первоначальным временем покупки / брони
-- В случае параллельной покупки мы скажем, что покупка произошла позже чем продление.
-- "Фантомная запись" ни на что не влияет, т.к. мы обновляем табличку Tickets в случае наличия уже существующей брони.
-- "Косая запись" ни на что не влияет, т.к мы работаем с одной записью