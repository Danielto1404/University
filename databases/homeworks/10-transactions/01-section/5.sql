start transaction read write isolation level repeatable read;
-- RU – не подходит, т.к мы изменяем таблицу Tickets
-- RC – не подходит:
-- В случае если бы у нас была отмена брони, то RC – было бы не достаточно, т.к мы могли купить место,
-- которые уже было не зарезервированное нами, также если с одного аккаунта мы параллельно покупаем / бронируем место,
-- то наша функция два раза вернет, что мы удачно купили / забронировали место, в случае брони ничего страшного нет,
-- можем сказать, что бронь произошла раньше и будет небольшая погрешность, а вот в случае покупки
-- мы вернем true в двух запросах (удачная покупка) и теоретически могут быть дважды списаны деньги,
-- поэтому минимальный уровень изоляции RR.
-- "Фантомная запись" ни на что не влияет, т.к. мы обновляем табличку Tickets в случае наличия уже существующей брони.
-- "Косая запись" ни на что не влияет, т.к мы работаем с одной записью