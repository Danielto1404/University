## Лабораторная работа 2-4. Потоки

+ A [Максимальный поток минимальной стоимости](#A)
+ B [Задача о назначениях](#B)
+ C [Камень, ножницы, бумага — 2](#C)
+ D [Задача коммивояжеров](#D)
+ E [В поисках невест](#E)


<a name="A"></a>
<h1 align="center">A. Максимальный поток минимальной стоимости</h1>
<p align="center"><i>ограничение по времени на тест 5 секунд<br>
ограничение по памяти на тест 512 мегабайт<br>
ввод: стандартный ввод<br>
вывод: стандартный вывод</i></p>


Задан ориентированный граф, каждое ребро которого обладает пропускной способностью и стоимостью. Найдите максимальный поток минимальной стоимости из вершины с номером 1 в вершину с номером n.

### Входные данные

Первая строка входного файла содержит n и m — количество вершин и количество ребер графа (2 ≤ n ≤ 100, 1 ≤ m ≤ 1000). Следующие m строк содержат по четыре целых числа числа: номера вершин, которые соединяет соответствующее ребро графа, его пропускную способность и его стоимость. Пропускные способности и стоимости не превосходят 105.

### Выходные данные

В выходной файл выведите одно число — цену максимального потока минимальной стоимости из вершины с номером 1 в вершину с номером n. Ответ не превышает 2^63 - 1. Гарантируется, что в графе нет циклов отрицательной стоимости.

### Пример
#### Входные данные
```
4 5
1 2 1 2
1 3 2 2
3 2 1 1
2 4 2 1
3 4 2 3
```

#### Выходные данные
```
12
```

---

<a name="B"></a>
<h1 align="center">B. Задача о назначениях</h1>
<p align="center"><i>ограничение по времени на тест 2 секунды<br>
ограничение по памяти на тест 256 мегабайт<br>
ввод: стандартный ввод<br>
вывод: стандартный вывод</i></p


Дана целочисленная матрица C размера n × n. Требуется выбрать n ячеек так, чтобы в каждой строке и каждом столбце была выбрана ровно одна ячейка, а сумма значений в выбранных ячейках была минимальна.

### Входные данные

Первая строка входного файла содержит n (2 ≤ n ≤ 300). Каждая из последующих n строк содержит по n чисел: Cij Все значения во входном файле неотрицательны и не превосходят 106.

### Выходные данные

В первую строку выходного файла выведите одно число — искомая минимизуруемая величина. Далее выведите n строк по два числа в каждой — номер строки и столбца клетки, участвующей в оптимальном назначении.

Пары чисел можно выводить в произвольном порядке.

### Пример
#### Входные данные
```
3
3 2 1
1 3 2
2 1 3
```

#### Выходные данные
```
3
2 1
3 2
1 3
```

---

<a name="С"></a>
<h1 align="center">С. Камень, ножницы, бумага — 2</h1>
<p align="center"><i>ограничение по времени на тест 1 секунда<br>
ограничение по памяти на тест 512 мегабайт<br>
ввод: стандартный ввод<br>
вывод: стандартный вывод</i></p


Год назад Ростислав с Мирославом играли в камень, ножницы, бумагу на щелбаны. За каждый выигранный раунд победитель ставил один щелбан проигравшему. В случае ничьи щелбаны не ставились. Эта игра запомнилась Мирославу как самая худшая игра в его жизни: всю следующую неделю у него болел лоб.

Воспоминания нахлынули на Мирослава, когда он нашел бумажку с шестью числами — запись с той самой игры. Прошло много времени, и теперь Мирослав может спокойно подумать, почему он проиграл так много раз. Но, к сожалению, он не может посчитать точное количество своих поражений, так как он записал только то, что Ростислав показал камень r1 раз, ножницы s1 раз и бумагу p1 раз, а сам Мирослав показал камень r2 раз, ножницы s2 раз и бумагу p2 раз.

Помогите Мирославу узнать по этим данным, какое минимальное количество щелбанов он мог получить в той самой роковой игре.

Для справки, победитель этой игры определяется по следующим правилам:

Если игроки показали одинаковый знак, то засчитывается ничья.

### Входные данные

В первой строке входных данных три целых числа r1, s1, p1. Во второй строке три целых числа r2, s2, p2.

Все числа неотрицательные и не превышают 108, r1 + s1 + p1 = r2 + s2 + p2.

### Выходные данные

Выходные данные должны содержать единственное число  — минимальное количество щелбанов, которые мог получить Мирослав.

### Примеры
#### Входные данные
```
3 0 0
0 3 0
```

#### Выходные данные
```
3
```

---

<a name="D"></a>
<h1 align="center">D. Задача коммивояжеров</h1>
<p align="center"><i>ограничение по времени на тест 2 секунды<br>
ограничение по памяти на тест 256 мегабайт<br>
ввод: стандартный ввод<br>
вывод: стандартный вывод</i></p


Есть n городов. Между городами есть ориентированные дороги, у каждой дороги есть стоимость покупки разрешения на проезд. Мы хотим торговать во всех городах. У нас есть неограниченное кол-во коммивояжеров. Для каждого из них мы должны определить список городов, в которых они будут торговать. Каждый коммивояжер будет объезжать все города из своего списка по циклу (он может по пути заезжать в другие города, но не торговать там). Если два (или более) коммивояжеров будут ездить по одной дороге, то каждому из них мы должны купить разрешение на проезд. Если список у коммивояжера состоит только из одного города, то он либо должен регулярно выезжать из города (тоже по какому-то циклу), либо мы должны купить ему прописку (у каждого города есть цена прописки). Наконец, в любом городе должен торговать только один коммивояжер, иначе предприятием заинтересуется налоговая. Нужно минимизировать издержки.

#### Входные данные

В первой строке два числа n, m — количество городов и количество дорог (1 ≤ n ≤ 256, 0 ≤ m ≤ n(n - 1)).
Во второй строке n чисел a i — цена прописки для города номер i (0 ≤ a i ≤ 109).
Затем в m строках описаны дороги. Описание дороги из города u в город v со стоимостью разрешения на проезд c выглядит как u v cost (1 ≤ u, v ≤ n, u ≠ v, 0 ≤ c ≤ 109). Гарантируется, что между любой парой городов не более 1 дороги в каждом из направлений.

#### Выходные данные

Выведите одно число — минимальную сумму издержек.

#### Примеры

+ Входные данные

```
5 5
--...
A-.#-
.#.#-
--.--
--.-B
```

+ Выходные данные

```
3 3
30 25 30
1 2 3
2 3 5
3 1 10
```

***

+ Входные данные

```
18
```

---

<a name="E"></a>
<h1 align="center">E. В поисках невест</h1>
<p align="center"><i>ограничение по времени на тест 2 секунды<br>
ограничение по памяти на тест 256 мегабайт<br>
ввод: стандартный ввод<br>
вывод: стандартный вывод</i></p


Однажды король Флатландии решил отправить k своих сыновей на поиски невест. Всем известно, что во Флатландии n городов, некоторые из которых соединены дорогами. Король живет в столице, которая имеет номер 1, а город с номером n знаменит своими невестами.

Итак, король повелел, чтобы каждый из его сыновей добрался по дорогам из города 1 в город n. Поскольку, несмотря на обилие невест в городе n, красивых среди них не так много, сыновья опасаются друг друга. Поэтому они хотят добраться до цели таким образом, чтобы никакие два сына не проходили по одной и той же дороге (даже в разное время). Так как король любит своих сыновей, он хочет, чтобы среднее время сына в пути до города назначения было минимально.


#### Входные данные

В первой строке входного файла находятся числа n, m и k — количество городов и дорог во Флатландии и сыновей короля, соответственно (2 ≤ n ≤ 200, 1 ≤ m ≤ 2000, 1 ≤ k ≤ 100). Следующие m строк содержат по три целых положительных числа каждая — города, которые соединяет соответствующая дорога и время, которое требуется для ее прохождения (время не превышает 106). По дороге можно перемещаться в любом из двух направлений, два города могут быть соединены несколькими дорогами.

#### Выходные данные

Если выполнить повеление короля невозможно, выведите на первой строке число  - 1. В противном случае выведите на первой строке минимальное возможное среднее время (с точностью 5 знаков после десятичной точки), которое требуется сыновьям, чтобы добраться до города назначения, не менее чем с пятью знаками после десятичной точки. В следующих k строках выведите пути сыновей, сначала число дорог в пути, и затем номера дорог в пути в том порядке, в котором их следует проходить. Дороги нумеруются, начиная с единицы, в том порядке, в котором они заданы во входном файле.

#### Пример

+ Входные данные

```
5 8 2
1 2 1
1 3 1
1 4 3
2 5 5
2 3 1
3 5 1
3 4 1
5 4 1
```

+ Выходные данные

```
3.00000
2 2 6
2 3 8
```

---
